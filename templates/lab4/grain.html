{% extends "base.html" %}

{% block lab %}Заказ зерна{% endblock %}

{% block main %}
    <h1>Заказ зерна</h1>
    
    <form method="post">
        <div>
            <label for="grain_type">Тип зерна:</label>
            <select id="grain_type" name="grain_type">
                <option value="">Выберите зерно</option>
                <option value="barley" {% if selected_grain == 'barley' %}selected{% endif %}>Ячмень - 12 000 руб/т</option>
                <option value="oats" {% if selected_grain == 'oats' %}selected{% endif %}>Овёс - 8 500 руб/т</option>
                <option value="wheat" {% if selected_grain == 'wheat' %}selected{% endif %}>Пшеница - 9 000 руб/т</option>
                <option value="rye" {% if selected_grain == 'rye' %}selected{% endif %}>Рожь - 15 000 руб/т</option>
            </select>
        </div>
        
        <div>
            <label for="weight">Вес (тонны):</label>
            <input type="number" id="weight" name="weight" 
                   value="{{ weight or '' }}" step="0.1">
        </div>
        
        <div>
            <button type="submit">Оформить заказ</button>
        </div>
    </form>

    {% if error %}
        <div class="error-message">{{ error }}</div>
    {% endif %}

    {% if success %}
        <div class="success-message">
            <h3>Заказ успешно сформирован</h3>
            <p>Вы заказали <strong>{{ grain_name }}</strong>.</p>
            <p>Вес: <strong>{{ weight }} т</strong>.</p>
            <p>Сумма к оплате: <strong>{{ "%.2f"|format(total) }} руб</strong>.</p>
            
            {% if discount > 0 %}
                <div class="discount-info">
                    <p>Применена скидка 10% за большой объём</p>
                    <p>Размер скидки: <strong>{{ "%.2f"|format(discount) }} руб</strong></p>
                </div>
            {% endif %}
        </div>
    {% endif %}

    <style>
        .error-message {
            color: #d32f2f;
            font-weight: bold;
            margin: 15px 0;
            padding: 10px;
            background-color: #ffebee;
            border-left: 4px solid #ff4444;
            border-radius: 4px;
            max-width: 400px;
        }
        
        .success-message {
            color: #2e7d32;
            margin: 15px 0;
            padding: 15px;
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            border-radius: 4px;
            max-width: 500px;
        }
    </style>
{% endblock %}